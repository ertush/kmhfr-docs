"use strict";(self.webpackChunkkmhfr_docs=self.webpackChunkkmhfr_docs||[]).push([[6715],{6606:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>a,toc:()=>h});var o=n(3274),s=n(789);const r={sidebar_position:1},i="Authentication",a={id:"Guide/authentiation",title:"Authentication",description:"You have just learned how to set up the Master Facility Registry Development Server.",source:"@site/docs/Guide/authentiation.md",sourceDirName:"Guide",slug:"/Guide/authentiation",permalink:"/docs/Guide/authentiation",draft:!1,unlisted:!1,editUrl:"https://github.com/uonafya/kmhfr-docs/tree/main/docs/Guide/authentiation.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Guide",permalink:"/docs/category/guide"},next:{title:"KMHFR API",permalink:"/docs/category/kmhfr-api"}},l={},h=[{value:"OAuth token based authentication",id:"oauth-token-based-authentication",level:2},{value:"Generate auth token",id:"generate-auth-token",level:3},{value:"Use token to make request",id:"use-token-to-make-request",level:3}];function d(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"authentication",children:"Authentication"})}),"\n",(0,o.jsx)(t.p,{children:"You have just learned how to set up the Master Facility Registry Development Server.\nLets look at how we can get authorization to consume the resources from our development server."}),"\n",(0,o.jsx)(t.p,{children:"To access resources from Master Health Facility Registry REST API you will need to get a valid auth token as shown below"}),"\n",(0,o.jsx)(t.h2,{id:"oauth-token-based-authentication",children:"OAuth token based authentication"}),"\n",(0,o.jsx)(t.h3,{id:"generate-auth-token",children:"Generate auth token"}),"\n",(0,o.jsxs)(t.p,{children:["To generate the auth token you will need to have the server running and setup to listen on your preferred port. To get the token you will need to make a request to ",(0,o.jsx)(t.code,{children:"/o/token"})," endpoint."]}),"\n",(0,o.jsx)(t.p,{children:"The request requires the following:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["A user account which will have ",(0,o.jsx)(t.strong,{children:"username"})," and a ",(0,o.jsx)(t.strong,{children:"password"})," that is currently in the database"]}),"\n",(0,o.jsx)(t.admonition,{title:"Creating a user account in MFR",type:"info",children:(0,o.jsx)(t.p,{children:"Please note that you may not have a user account after setting up the server. To create one, use the django admin web portal to create a user."})}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["A ",(0,o.jsx)(t.strong,{children:"Client ID"}),", which is usually generated for you by django"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["A ",(0,o.jsx)(t.strong,{children:"Client Secret"}),", which is also system generated when you setup MFR"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"To generate the token you can use the tool of your choise to make the http request. In this tutorial we will use curl, which you can easily install and is installed by default in most linux distributions"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-curl",children:'curl -X POST \\\n-d "grant_type=password&username=<user_email>&password=<user_password>&scope=read" \\\n-u "5O1KlpwBb96ANWe27ZQOpbWSF4DZDm4sOytwdzGv:PqV0dHbkjXAtJYhY9UOCg \\\nRVi5BzLhiDxGU91kbt5EoayQ5SYOoJBYRYAYlJl2RetUeDMpSvhe9DaQr0HKHan0 \\\nB9ptVyoLvOqpekiOmEqUJ6HZKuIoma0pvqkkKDU9GPv" \\\nhttps://api.kmhfr.health.go.ke/o/token/\n'})}),"\n",(0,o.jsxs)(t.p,{children:["This ",(0,o.jsx)(t.code,{children:"5O1KlpwBb96ANWe27ZQOpbWSF4DZDm4sOytwdzGv"})," is the ",(0,o.jsx)(t.strong,{children:"Client ID"})," while ",(0,o.jsx)(t.code,{children:"PqV0dHbkjXAtJYhY9UOCg     RVi5BzLhiDxGU91kbt5EoayQ5SYOoJBYRYAYlJl2RetUeDMpSvhe9DaQr0HKHan0"})," is the ",(0,o.jsx)(t.strong,{children:"Client Secret"})," from the example above"]}),"\n",(0,o.jsxs)(t.p,{children:["Make sure to replace ",(0,o.jsx)(t.code,{children:"<user_email>"})," and ",(0,o.jsx)(t.code,{children:"<user_password>"})," with your respective login credentials, as well as the client id and client secret in ",(0,o.jsx)(t.code,{children:'-u "5O1KlpwBb96ANWe27ZQOpbWSF4DZDm4sOytwdzGv:PqV0dHbkjXAtJYhY9UOCg \\     RVi5BzLhiDxGU91kbt5EoayQ5SYOoJBYRYAYlJl2RetUeDMpSvhe9DaQr0HKHan0 \\     B9ptVyoLvOqpekiOmEqUJ6HZKuIoma0pvqkkKDU9GPv"'}),"."]}),"\n",(0,o.jsx)(t.h3,{id:"use-token-to-make-request",children:"Use token to make request"}),"\n",(0,o.jsx)(t.p,{children:"Once you have the token add it to the header section of your request as illustrated below."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-typescript",metastring:'title="index.ts"',children:"\nconst url = \u201c/api/...\u201d\n\nasync fetchResource(url: string) {\n\n    return await fetch(url, {\n        headers:{\n        Authorization: `Bearer  ${<user_generated_token>}`,\n        . . .\n        }\n    })\n\n}\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Replace ",(0,o.jsx)(t.code,{children:"<user_generated_token>"})," with the token you generated above"]})]})}function c(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},789:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var o=n(9474);const s={},r=o.createContext(s);function i(e){const t=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(r.Provider,{value:t},e.children)}}}]);